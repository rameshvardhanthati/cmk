sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(t,e,i,o){"use strict";return t.extend("com.sap.changemaker.wizard.changemakerwizard.controller.Wizard",{onInit:function(){this._wizard=this.byId("CreateProductWizard");this._oNavContainer=this.byId("wizardNavContainer");this._oWizardContentPage=this.byId("wizardContentPage");var t=this.getView().getModel();console.log(t)},onCustomerChange:function(t){let e=this.getView().byId("cbIndustry");var i=t.oSource.mProperties.selectedKey;e.setValue(i)},onAdd:function(){let t=this.getView().getModel("kpiModel").getData();t.push({title:"",percent:""});this.getView().getModel("kpiModel").refresh()},setProductType:function(t){var e=t.getSource().getTitle();this.model.setProperty("/productType",e);this.byId("ProductStepChosenType").setText("Chosen product type: "+e);this._wizard.validateStep(this.byId("ProductTypeStep"))},setProductTypeFromSegmented:function(t){var e=t.getParameters().item.getText();this.model.setProperty("/productType",e);this._wizard.validateStep(this.byId("ProductTypeStep"))},additionalInfoValidation:function(){var t=this.byId("ProductName").getValue();var e=parseInt(this.byId("ProductWeight").getValue());if(isNaN(e)){this.model.setProperty("/productWeightState","Error")}else{this.model.setProperty("/productWeightState","None")}if(t.length<6){this.model.setProperty("/productNameState","Error")}else{this.model.setProperty("/productNameState","None")}if(t.length<6||isNaN(e)){this._wizard.invalidateStep(this.byId("ProductInfoStep"))}else{this._wizard.validateStep(this.byId("ProductInfoStep"))}},optionalStepActivation:function(){i.show("This event is fired on activate of Step3.")},optionalStepCompletion:function(){i.show("This event is fired on complete of Step3. You can use it to gather the information, and lock the input data.")},pricingActivate:function(){this.model.setProperty("/navApiEnabled",true)},pricingComplete:function(){this.model.setProperty("/navApiEnabled",false)},scrollFrom4to2:function(){this._wizard.goToStep(this.byId("ProductInfoStep"))},goFrom4to3:function(){if(this._wizard.getProgressStep()===this.byId("PricingStep")){this._wizard.previousStep()}},goFrom4to5:function(){if(this._wizard.getProgressStep()===this.byId("PricingStep")){this._wizard.nextStep()}},wizardCompletedHandler:function(){let t=this.getView().byId("kpiForm");t.destroyContent();let i=this.getView().byId("cbCustomer").mProperties.value;let o=this.getView().byId("cbIndustry").mProperties.value;let r=this.getView().byId("cbProductName").mProperties.value;let a=this.getView().byId("cbPurposeStatement").mProperties.value;let n=this.getView().byId("cmfDateRangeSelection").mProperties.dateValue;console.log(n);let s=this.getView().byId("cmfLocation").mProperties.value;let d=this.getView().byId("cbSAPSystem").mProperties.value;let p=this.getView().byId("cbSystemIntegrator").mProperties.value;let c=this.getView().byId("cbOCM").mProperties.value;let h=this.getView().byId("cmfChangeManager").mProperties.value;let l=this.getView().byId("cmfStatus").mProperties.value;let u=this.getView().byId("KPITable").getItems();let g=[];let m=u.forEach(function(t){g.push({title:t.mAggregations.cells[0].mProperties.value,percentage:t.mAggregations.cells[1].mProperties.value})});var y={name:i,industry:o,product:r,purposestatement:a,date:n,location:s,SAPsystem:d,systemintegrator:p,ocmpartner:c,changemanager:h,status:l,kpi:g};console.log(y);var f=new e(y);this.getView().setModel(f,"reviewModel");g.forEach(function(e){var i=new sap.m.Label;i.setText(e.title);t.addContent(i);var o=new sap.m.Text;o.setText(e.percentage+" %");t.addContent(o)});var P=new sap.m.Link;P.setText("Edit");P.attachPress(this.editStepThree,this);t.addContent(P);this._oNavContainer.to(this.byId("wizardReviewPage"))},backToWizardContent:function(){this._oNavContainer.backToPage(this._oWizardContentPage.getId())},editStepOne:function(){this._handleNavigationToStep(0)},editStepTwo:function(){this._handleNavigationToStep(1)},editStepThree:function(){this._handleNavigationToStep(2)},_handleNavigationToStep:function(t){var e=function(){this._wizard.goToStep(this._wizard.getSteps()[t]);this._oNavContainer.detachAfterNavigate(e)}.bind(this);this._oNavContainer.attachAfterNavigate(e);this.backToWizardContent()},_handleMessageBoxOpen:function(t,e){o[e](t,{actions:[o.Action.YES,o.Action.NO],onClose:function(t){if(t===o.Action.YES){this._handleNavigationToStep(0);this._wizard.discardProgress(this._wizard.getSteps()[0])}}.bind(this)})},_setEmptyValue:function(t){this.model.setProperty(t,"n/a")},handleWizardCancel:function(){this._handleMessageBoxOpen("Are you sure you want to cancel your report?","warning")},handleWizardSubmit:function(){this._handleMessageBoxOpen("Are you sure you want to submit your report?","confirm")},productWeighStateFormatter:function(t){return isNaN(t)?"Error":"None"},discardProgress:function(){this._wizard.discardProgress(this.byId("ProductTypeStep"));var t=function(e){for(var i=0;i<e.length;i++){if(e[i].setValue){e[i].setValue("")}if(e[i].getContent){t(e[i].getContent())}}};this.model.setProperty("/productWeightState","Error");this.model.setProperty("/productNameState","Error");t(this._wizard.getSteps())}})});